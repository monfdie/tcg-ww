<%- include('../partials/header') %>

<style>
    .page-container {
        max-width: 1600px !important; /* –ë—ã–ª–æ 1200px */
    }
</style>

<div class="page-container">

    <div class="filters-container">
        <span style="color: #8da4c4; margin-right: 10px; font-size: 0.9em;">Filters:</span>
        <button class="filter-pill" onclick="toggleFilter('AS', this)">AS</button>
        <button class="filter-pill" onclick="toggleFilter('NA', this)">NA</button>
        <button class="filter-pill" onclick="toggleFilter('EU', this)">EU</button>
        <button class="filter-pill" onclick="toggleFilter('Draft', this)">Draft</button>
        <button class="filter-pill" onclick="toggleFilter('Allpick', this)">All pick</button>
    </div>

    <div class="section-header">
        <div class="live-indicator"></div>
        <h2>Live Events</h2>
    </div>

    <div class="tournament-list" id="list-active">
        <% if (tournaments && tournaments.length > 0) { %>
            <% tournaments.forEach(tour => { %>
                <a href="<%= (tour.regLink && tour.regLink.startsWith('http')) ? tour.regLink : '/tournament/' + tour.slug %>" 
                   class="tour-rect-card" 
                   target="<%= (tour.regLink && tour.regLink.startsWith('http')) ? '_blank' : '_self' %>"
                   data-tags="<%= tour.region %> <%= tour.system %>">
                    
                    <div class="card-center">
                        <div class="card-title"><%= tour.title %></div>
                        <div class="card-hashtags">
                            <span><%= tour.slug %></span>
                            <span class="dot-separator">‚Ä¢</span>
                            <span><%= tour.region %></span>
                            <span class="dot-separator">‚Ä¢</span>
                            <span><%= tour.system %></span>
                        </div>
                    </div>

                    <div class="card-right">
                        <div class="info-group">
                            <label>Draft system</label>
                            <span><%= tour.system %></span>
                        </div>
                        <div class="info-group">
                            <label>Prize</label>
                            <span class="prize-text">üèÜ <%= tour.prize %></span>
                        </div>
                    </div>
                </a>
            <% }); %>
        <% } else { %>
            <div class="empty-state">No active tournaments.</div>
        <% } %>
    </div>

    <div class="section-header" style="margin-top: 40px;">
        <h2 style="color: #8da4c4;">Archive</h2>
    </div>

    <div class="tournament-list" id="list-archive">
        <% if (archive && archive.length > 0) { %>
            <% archive.forEach(tour => { %>
                <a href="<%= (tour.regLink && tour.regLink.startsWith('http')) ? tour.regLink : '/tournament/' + tour.slug %>" 
                   class="tour-rect-card archive-style" 
                   target="<%= (tour.regLink && tour.regLink.startsWith('http')) ? '_blank' : '_self' %>"
                   data-tags="<%= tour.region %> <%= tour.system %>">
                    
                    <div class="card-center">
                        <div class="card-title"><%= tour.title %></div>
                        <div class="card-hashtags">
                            <span><%= tour.slug %></span>
                            <span class="dot-separator">‚Ä¢</span>
                            <span><%= tour.date %></span>
                        </div>
                    </div>

                    <div class="card-right">
                        <div class="info-group">
                            <label>System</label>
                            <span><%= tour.system %></span>
                        </div>
                        <div class="info-group">
                            <label>Prize</label>
                            <span class="prize-text">üèÜ <%= tour.prize %></span>
                        </div>
                    </div>
                </a>
            <% }); %>
        <% } else { %>
            <div class="empty-state">Archive is empty.</div>
        <% } %>
    </div>

</div>

<style>
    /* --- –§–ò–õ–¨–¢–†–´ --- */
    .filters-container {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }
    .filter-pill {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid #3c4566;
        color: #8da4c4;
        padding: 6px 16px;
        border-radius: 20px;
        cursor: pointer;
        font-family: 'Segoe UI', sans-serif;
        font-size: 0.9em;
        transition: 0.2s;
    }
    .filter-pill:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
    }
    .filter-pill.active {
        background: #4facfe;
        color: #0b0d17;
        border-color: #4facfe;
        font-weight: bold;
    }

    /* --- –ó–ê–ì–û–õ–û–í–ö–ò –†–ê–ó–î–ï–õ–û–í --- */
    .section-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
        border-bottom: 1px solid #2a3454;
        padding-bottom: 10px;
    }
    .section-header h2 {
        font-family: 'Segoe UI', sans-serif;
        font-size: 1.2em;
        margin: 0;
        color: #fff;
    }
    .live-indicator {
        width: 8px;
        height: 8px;
        background: #ff4444;
        border-radius: 50%;
        box-shadow: 0 0 10px #ff4444;
    }

    /* --- –ö–ê–†–¢–û–ß–ö–ê –¢–£–†–ù–ò–†–ê --- */
    .tournament-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .tour-rect-card {
        display: flex;
        align-items: center;
        background: #161c30;
        border: 1px solid #2a3454;
        border-radius: 4px;
        text-decoration: none;
        transition: 0.2s;
        height: 80px;
        overflow: hidden;
        padding-left: 25px; /* –û—Ç—Å—Ç—É–ø —Å–ª–µ–≤–∞ –≤–º–µ—Å—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ */
    }
    .tour-rect-card:hover {
        background: #1e2538;
        border-color: #4facfe;
    }

    /* –¶–µ–Ω—Ç—Ä (–ù–∞–∑–≤–∞–Ω–∏–µ) */
    .card-center {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .card-title {
        color: #fff;
        font-size: 1.1em;
        font-weight: bold;
        margin-bottom: 5px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .card-hashtags {
        display: flex;
        gap: 8px;
        font-size: 0.85em;
        color: #6a7b9c;
        align-items: center;
    }
    .dot-separator {
        font-size: 0.6em;
        color: #444;
    }

    /* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å (–ò–Ω—Ñ–æ) */
    .card-right {
        display: flex;
        gap: 40px;
        padding-right: 30px;
        text-align: right;
    }
    .info-group {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .info-group label {
        font-size: 0.75em;
        color: #556;
        margin-bottom: 2px;
    }
    .info-group span {
        color: #fff;
        font-size: 0.95em;
        font-weight: 500;
    }
    .prize-text { color: #fff; font-weight: bold; }

    /* –ê—Ä—Ö–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å */
    .archive-style { opacity: 0.7; }
    .empty-state { color: #556; padding: 20px; font-style: italic; }
</style>

<script>
    let activeFilters = new Set();

    function toggleFilter(tag, btn) {
        if (activeFilters.has(tag)) {
            activeFilters.delete(tag);
            btn.classList.remove('active');
        } else {
            activeFilters.add(tag);
            btn.classList.add('active');
        }
        applyFilters();
    }

    function applyFilters() {
        const cards = document.querySelectorAll('.tour-rect-card');
        
        cards.forEach(card => {
            if (activeFilters.size === 0) {
                card.style.display = 'flex';
                return;
            }

            const cardTags = card.getAttribute('data-tags');
            let isVisible = false;
            activeFilters.forEach(filter => {
                if (cardTags.includes(filter)) isVisible = true;
            });

            if (isVisible) {
                card.style.display = 'flex';
            } else {
                card.style.display = 'none';
            }
        });
    }
</script>

<%- include('../partials/footer') %>
